<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-0.11.0 docs-doc-page docs-doc-id-writing-reactors/preambles" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">Preambles | Lingua Franca</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://www.lf-lang.org/img/lf-social-card.png"><meta data-rh="true" name="twitter:image" content="https://www.lf-lang.org/img/lf-social-card.png"><meta data-rh="true" property="og:url" content="https://www.lf-lang.org/docs/writing-reactors/preambles/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="0.11.0"><meta data-rh="true" name="docusaurus_tag" content="docs-default-0.11.0"><meta data-rh="true" name="docsearch:version" content="0.11.0"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-0.11.0"><meta data-rh="true" property="og:title" content="Preambles | Lingua Franca"><meta data-rh="true" name="description" content="Defining preambles in Lingua Franca."><meta data-rh="true" property="og:description" content="Defining preambles in Lingua Franca."><link data-rh="true" rel="icon" href="../../../img/favicon.png"><link data-rh="true" rel="canonical" href="https://www.lf-lang.org/docs/writing-reactors/preambles/"><link data-rh="true" rel="alternate" href="https://www.lf-lang.org/docs/writing-reactors/preambles/" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.lf-lang.org/docs/writing-reactors/preambles/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://U5IWIJW31Z-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="../../../blog/rss.xml" title="Lingua Franca RSS Feed">
<link rel="alternate" type="application/atom+xml" href="../../../blog/atom.xml" title="Lingua Franca Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Lingua Franca" href="../../../opensearch.xml"><link rel="stylesheet" href="../../../assets/css/styles.ba30d6af.css">
<script src="../../../assets/js/runtime~main.cb523eb3.js" defer="defer"></script>
<script src="../../../assets/js/main.0ff8ee1b.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="../../../index.html"><div class="navbar__logo"><img src="../../../img/lf-forlight.svg" alt="The Lingua Franca Logo" class="lf-navbar-logo themedComponent_mlkZ themedComponent--light_NVdE"><img src="../../../img/lf-fordark.svg" alt="The Lingua Franca Logo" class="lf-navbar-logo themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="../../index.html">Handbook</a><a class="navbar__item navbar__link" href="../../../blog/index.html">Blog</a><a class="navbar__item navbar__link" href="../../../research/index.html">Research</a><a class="navbar__item navbar__link" href="../../../community/index.html">Community</a><a class="navbar__item navbar__link" href="../../../events/index.html">Events</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="index.html">0.11.0</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="../../next/writing-reactors/preambles/index.html">Nightly ðŸš§</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="index.html">0.11.0</a></li><li><a class="dropdown__link" href="../../0.10.0/writing-reactors/preambles/index.html">0.10.0</a></li><li><a class="dropdown__link" href="../../0.9.0/writing-reactors/preambles/index.html">0.9.0</a></li><li><a class="dropdown__link" href="../../0.8.0/writing-reactors/preambles/index.html">0.8.0</a></li><li><a class="dropdown__link" href="../../0.7.0/writing-reactors/preambles/index.html">0.7.0</a></li><li><a class="dropdown__link" href="../../0.6.0/writing-reactors/preambles/index.html">0.6.0</a></li><li><a class="dropdown__link" href="../../0.5.0/writing-reactors/preambles/index.html">0.5.0</a></li></ul></div><a href="https://github.com/lf-lang/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="../../index.html">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="../../installation/index.html">Installation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="../../videos/index.html">Videos</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="../a-first-reactor/index.html">Writing Reactors</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../a-first-reactor/index.html">A First Reactor</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../inputs-and-outputs/index.html">Inputs and Outputs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../parameters-and-state-variables/index.html">Parameters and State Variables</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../time-and-timers/index.html">Time and Timers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../composing-reactors/index.html">Composing Reactors</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../reactions/index.html">Reactions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../reaction-declarations/index.html">Reaction Declarations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../methods/index.html">Methods</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../causality-loops/index.html">Causality Loops</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../extending-reactors/index.html">Extending Reactors</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../actions/index.html">Actions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../superdense-time/index.html">Superdense Time</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../modal-models/index.html">Modal Reactors</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../deadlines/index.html">Deadlines</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../multiports-and-banks/index.html">Multiports and Banks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../generics/index.html">Generic Reactors</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="index.html">Preambles</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../distributed-execution/index.html">Distributed Execution</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../termination/index.html">Termination</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="../../tools/code-extension/index.html">Tools</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="../../reference/docker-support/index.html">Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="../../embedded/arduino/index.html">Embedded Platforms</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="../../developer/contributing/index.html">Developer</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="../../glossary/index.html">Glossary</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="../../../index.html"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Writing Reactors</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Preambles</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 0.11.0</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Preambles</h1></header><p>This article has examples in the following target languages:</p><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">C</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">C++</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Python</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Rust</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">TypeScript</li></ul><div class="margin-top--md"></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="preamble">Preamble<a href="#preamble" class="hash-link" aria-label="Direct link to Preamble" title="Direct link to Preamble">â€‹</a></h2>
<p>Reactions may contain arbitrary target-language code, but often it is convenient for that code to invoke external libraries or to share procedure definitions. For either purpose, a reactor may include a <code>preamble</code> section.</p>
<div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP hidden_PYVj tabs__item--active">c</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP hidden_PYVj">cpp</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP hidden_PYVj">py</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP hidden_PYVj">ts</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP hidden_PYVj">rs</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><p>For example, the following reactor uses the <code>math</code> C library for its trigonometric functions:</p><pre class="shiki"><code>main reactor {
  preamble {=
    #include &lt;math.h&gt;
  =}
  reaction(startup) {=
    printf(&quot;The cosine of 1 is %f.\n&quot;, cos(1));
  =}
}
</code></pre><p>This will print:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">The cosine of 1 is 0.540302.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>By putting the <code>#include</code> in the <code>preamble</code>, the library becomes available in all reactions of this reactor.
If you wish to have the library available in all reactors in the same file, you can provide the <code>preamble</code> outside the reactor, as shown here:</p><pre class="shiki"><code>preamble {=
  #include &lt;math.h&gt;
=}
reactor Cos {
  reaction(startup) {=
    printf(&quot;The cosine of 1 is %f.\n&quot;, cos(1));
  =}
}
reactor Sin {
  reaction(startup) {=
    printf(&quot;The sine of 1 is %f.\n&quot;, sin(1));
  =}
}
main reactor {
  c = new Cos()
  s = new Sin()
}
</code></pre><p>You can also use the <code>preamble</code> to define functions that are shared across reactions within a reactor, as in this example:</p><pre class="shiki"><code>main reactor {
  preamble {=
    int add_42(int i) {
      return i + 42;
    }
  =}
  reaction(startup) {=
    printf(&quot;42 plus 42 is %d.\n&quot;, add_42(42));
  =}
  reaction(startup) {=
    printf(&quot;42 plus 1 is %d.\n&quot;, add_42(1));
  =}
}
</code></pre><p>Not surprisingly, this will print:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">42 plus 42 is 84.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">42 plus 1 is 43.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>(The order in which these are printed is arbitrary because the reactions can execute in parallel.)</p><p>To share a function across <em>reactors</em>, however, is a bit trickier.
A <code>preamble</code> that is put outside the <code>reactor</code> definition can only contain
<em>declarations</em> not <em>definitions</em> of functions or variables.
The following code, for example will <strong>fail to compile</strong>:</p><pre class="shiki"><code>preamble {=
  int add_42(int i) {
    return i + 42;
  }
=}
reactor Add_42 {
  reaction(startup) {=
    printf(&quot;42 plus 42 is %d.\n&quot;, add_42(42));
  =}
}
reactor Add_1 {
  reaction(startup) {=
    printf(&quot;42 plus 1 is %d.\n&quot;, add_42(1));
  =}
}
main reactor {
  a = new Add_42()
  b = new Add_1()
}
</code></pre><p>The compiler will issue a <strong>duplicate symbol</strong> error because the function definition gets repeated in the separate C files generated for the two reactor classes, <code>Add_42</code> and <code>Add_1</code>. When the compiled C code gets linked, the linker will find two definitions for the function <code>add_42</code>.</p><p>To correct this compile error, the file-level preamble should contain only a <em>declaration</em>, not a <em>definition</em>, as here:</p><pre class="shiki"><code>preamble {=
  int add_42(int i);
=}
reactor Add_42 {
  reaction(startup) {=
    printf(&quot;42 plus 42 is %d.\n&quot;, add_42(42));
  =}
}
reactor Add_1 {
  reaction(startup) {=
    printf(&quot;42 plus 1 is %d.\n&quot;, add_42(1));
  =}
}
main reactor {
  preamble {=
    int add_42(int i) {
      return i + 42;
    }
  =}
  a = new Add_42()
  b = new Add_1()
}
</code></pre><p>The function <em>definition</em> here is put into the main reactor, but it can be put in any reactor defined in the file.</p><p>Most header files contain only declarations, and hence can be safely included
using <code>#include</code> in a file-level <code>preamble</code>. If you wish to use a header file that includes both declarations and definitions, then you will need to include it within each reactor that uses it.</p><p>If you wish to share <em>variables</em> across reactors, similar constraints apply.
Note that sharing variables across reactors is <strong>strongly discouraged</strong> because it can undermine the determinacy of Lingua Franca, and you may have to implement mutual-exclusion locks to access such variables. But it is occassionaly justfiable, as in the following example:</p><pre class="shiki"><code>preamble {=
  extern const char shared_string[];
=}
reactor A {
  reaction(startup) {=
    printf(&quot;Reactor A says %s.\n&quot;, shared_string);
  =}
}
reactor B {
  reaction(startup) {=
    printf(&quot;Reactor B says %s.\n&quot;, shared_string);
  =}
}
main reactor {
  preamble {=
    const char shared_string[] = &quot;Hello&quot;;
  =}
  a = new A()
  b = new B()
}
</code></pre><p>Notice the use of the <code>extern</code> keyword in C, which is required because the <em>definition</em> of the <code>shared_string</code> variable will be in a separate (code-generated) C file, the one for <code>main</code>, not the ones for <code>A</code> and <code>B</code>.</p><p>One subtlety is that if you define symbols that you will use in <code>input</code>, <code>output</code>, or <code>state</code> declarations, then the symbols <em>must</em> be defined in a file-level <code>preamble</code>.
Specifically, the following code will <strong>fail to compile</strong>:</p><pre class="shiki"><code>main reactor {
  preamble {=
    typedef int foo;
  =}
  state x:foo = 0
  reaction(startup) {=
    lf_print(&quot;State is %d&quot;, self-&gt;x);
  =}
}
</code></pre><p>The compiler will issue an <strong>unknown type name</strong> error. To correct this, just move the declaration to a file-level <code>preamble</code>:</p><pre class="shiki"><code>preamble {=
  typedef int foo;
=}
main reactor {
  state x:foo = 0
  reaction(startup) {=
    lf_print(&quot;State is %d&quot;, self-&gt;x);
  =}
}
</code></pre></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>For example, the following reactor uses the <code>charconv</code> header from the c++ standard library to convert a string to an integer:</p><pre class="shiki"><code>target Cpp;

main reactor {
  private preamble {=
    #include &lt;charconv&gt;
    #include &lt;string&gt;
  =}

  timer t;
  reaction(t) {=
    std::string raw = &quot;42&quot;;
    std::size_t number;

    auto result = std::from_chars(raw.data(), raw.data() + raw.size(), number);
    if (result.ec == std::errc::invalid_argument) {
      std::cerr &lt;&lt; &quot;Could not convert.&quot;;
    } else {
      std::cout &lt;&lt; &quot;Converted string: &quot; &lt;&lt; raw &lt;&lt; &quot; to integer: &quot; &lt;&lt; number &lt;&lt; std::endl;
    }
  =}
}
</code></pre><p>This will print:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[INFO]  Starting the execution</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Converted string: 42 to integer: 42</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[INFO]  Terminating the execution</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>By putting the #include in the preamble, the library becomes available in all reactions of this reactor. Note the private qualifier before the preamble keyword.
This ensures that the preamble is only visible to the reactions defined in this reactor and not to any other reactors. In contrast,
the public qualifier ensures that the preamble is also visible to other reactors in files that import the reactor defining the public preamble.</p><pre class="shiki"><code>reactor Preamble {
  public preamble {=
    struct MyStruct {
      int foo;
      std::string bar;
    };
  =}

  private preamble {=
    auto add_42(int i) noexcept -&gt; int {
      return i + 42;
    }
  =}

  logical action a:MyStruct;

  reaction(startup) {=
    a.schedule({add_42(42), &quot;baz&quot;});
  =}

  reaction(a) {=
    auto value = *a.get();
    std::cout &lt;&lt; &quot;Received &quot; &lt;&lt; value.foo &lt;&lt; &quot; and &#x27;&quot; &lt;&lt; value.bar &lt;&lt; &quot;&#x27;\n&quot;;
  =}
}
</code></pre><p>It defines both a public and a private preamble. The public preamble defines the type MyStruct. This type definition will be visible to all elements of the
Preamble reactor as well as to all reactors defined in files that import Preamble. The private preamble defines the function <code>add_42(int i)</code>.
This function will only be usable to reactions within the Preamble reactor.</p><p>You can think of public and private preambles as the equivalent of header files and source files in C++. In fact, the public preamble will be translated to a
header file and the private preamble to a source file. As a rule of thumb, all types that are used in port or action definitions as well as in state variables
or parameters should be defined in a public preamble. Also, declarations of functions to be shared across reactors should be placed in the public preamble.
Everything else, like function definitions or types that are used only within reactions, should be placed in a private preamble.</p><p>Note that preambles can also be specified on the file level. These file level preambles are visible to all reactors within the file.
An example of this can be found in <a href="https://github.com/lf-lang/lingua-franca/blob/master/test/Cpp/src/target/PreambleFile.lf" target="_blank" rel="noopener noreferrer">PreambleFile.lf</a>.</p><p>Admittedly, the precise interactions of preambles and imports can become confusing. The preamble mechanism will likely be refined in future revisions.</p><p>Note that functions defined in the preamble cannot access members such as state variables of the reactor unless they are explicitly passed as arguments.
If access to the inner state of a reactor is required, <a href="/docs/writing-reactors/methods/#method-declaration">methods</a> present a viable and easy to use alternative.</p></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>For example, the following reactor uses the <code>platform</code> module to print the platform information and a defined method to add 42 to an integer:</p><pre class="shiki"><code>main reactor Preamble {
	preamble {=
		import platform
		def add_42(self, i):
			return i + 42
	=}
	timer t;
	reaction(t) {=
		s = &quot;42&quot;
		i = int(s)
		print(&quot;Converted string {:s} to int {:d}.&quot;.format(s, i))
		print(&quot;42 plus 42 is &quot;, self.add_42(42))
		print(&quot;Your platform is &quot;, self.platform.system())
	=}
}
</code></pre><p>On a Linux machine, this will print:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Converted string 42 to int 42.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">42 plus 42 is 84</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Your platform is Linux</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>By putting import in the <code>preamble</code>, the module becomes available in all reactions of this reactor using the <code>self</code> modifier.</p><p><strong>Note:</strong> Preambles will be put in the generated Python class for the given reactor, and thus is part of the instance of the reactor. This means that anything you put in the preamble will be specific to a particular reactor instance and cannot be used to share information between different instantiations of the reactor (this is a feature, not a bug, because it helps ensure determinacy). For more information about implementation details of the Python target, see <a href="../../reference/target-language-details/index.html">Implementation Details</a>.</p><p>Alternatively, you can define a <code>preamble</code> outside any reactor definition. Such a <code>preamble</code> can be used for functions such as import or to define a global function. The following example shows importing the <a href="https://github.com/lf-lang/lingua-franca/blob/master/test/Python/src/include/hello.py" target="_blank" rel="noopener noreferrer">hello</a> module:</p><pre class="shiki"><code>target Python {
  files: include/hello.py
};
preamble {=
  import hello
=}
</code></pre><p>Notice the usage of the <code>files</code> target property to move the <code>hello.py</code> module located in the <code>include</code> folder of the test directory into the working directory (located in <code>src-gen/NAME</code>).</p><p>For another example, the following program uses the built-in Python <code>input()</code> function to get typed input from the user:</p><pre class="shiki"><code>target Python
main reactor {
  preamble {=
    import threading
    def external(self, a):
      while (True):
        from_user = input() # Blocking
        a.schedule(0, from_user)
  =}
  state thread
  physical action a
  timer t(2 secs, 2 secs)

  reaction(startup) -&gt; a {=
    self.thread = self.threading.Thread(target=self.external, args=(a,))
    self.thread.start()
    print(&quot;Type something.&quot;)
  =}

  reaction(a) {=
    elapsed_time = lf.time.logical_elapsed()
    print(f&quot;A time {elapsed_time} nsec after start, received: &quot;, a.value)
  =}

  reaction(t) {=
    print(&quot;Waiting ...&quot;)
  =}
}
</code></pre><p>Within the <code>preamble</code>, we specify to import the <code>threading</code> Python module and define a function that will be started in a separate thread in the reaction to <code>startup</code>. The thread function named <code>external</code> blocks when <code>input()</code> is called until the user types something and hits the return or enter key. Usually, you do not want a Lingua Franca program to block waiting for input. In the above reactor, a <code>timer</code> is used to repeatedly trigger a reaction that reminds the user that it is waiting for input.</p></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>For example, the following reactor uses Node&#x27;s built-in path module to extract the base name from a path:</p><pre class="shiki"><code>target TypeScript;
main reactor Preamble {
  preamble {=
    import * as path from &#x27;path&#x27;;
  =}
  reaction (startup) {=
    var filename = path.basename(&#x27;/Users/Refsnes/demo_path.js&#x27;);
    console.log(filename);
  =}
}
</code></pre><p>This will print:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">demo_path.js</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>By putting the <code>import</code> in the <strong>preamble</strong>, the library becomes available in all reactions of this reactor. Oddly, it also becomes available in all subsequently defined reactors in the same file. It&#x27;s a bit more complicated to <a href="#using-node-modules">set up Node.js modules from npm</a> that aren&#x27;t built-in, but the reaction code to <code>import</code> them is the same as what you see here.</p><p>You can also use the preamble to define functions that are shared across reactions and reactors:</p><pre class="shiki"><code>main reactor Preamble {
  preamble {=
    function add42( i:number) {
      return i + 42;
    }
  =}
  timer t;
  reaction(t) {=
    let s = &quot;42&quot;;
    let radix = 10;
    let i = parseInt(s, radix);
    console.log(&quot;Converted string &quot; + s + &quot; to number &quot; + i);
    console.log(&quot;42 plus 42 is &quot; + add42(42));
  =}
}
</code></pre><p>Not surprisingly, this will print:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Converted string 42 to number 42</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">42 plus 42 is 84</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-node-modules">Using Node Modules<a href="#using-node-modules" class="hash-link" aria-label="Direct link to Using Node Modules" title="Direct link to Using Node Modules">â€‹</a></h3><p>Installing Node.js modules for TypeScript reactors with <code>npm</code> is essentially the same as installing modules for an ordinary Node.js program. First, write a Lingua Franca program (<code>Foo.lf</code>) and compile it. It may not type check if if you&#x27;re importing modules in the preamble and you haven&#x27;t installed the modules yet, but compiling your program will cause the TypeScript code generator to <a href="../../reference/target-language-details/index.html">produce a project</a> for your program. There should now be a package.json file in the same directory as your .lf file. Open a terminal and navigate to that directory. You can use the standard <a href="https://docs.npmjs.com/cli/install" target="_blank" rel="noopener noreferrer"><code>npm install</code></a> command to install modules for your TypeScript reactors.</p><p>The important takeaway here is with the package.json file and the compiled JavaScript in the Foo/dist/ directory, you have a standard Node.js program that executes as such. You can modify and debug it just as you would a Node.js program.</p></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>For example, you can use the <code>preamble</code> to define macros and functions that are shared within the given reactor:</p><pre class="shiki"><code>target Rust;

main reactor {
  preamble {=
    macro_rules! add {
      ($a:expr, $b:expr) =&gt; {
        $a+$b
      }
    }
    fn add_42 (a: i32) -&gt; i32 {
      return a + 42;
    }
  =}

  reaction(startup) {
    println!(&quot;add macro example: {}&quot;, add!(1,1));
    println!(&quot;add 42 example: {}&quot;, add_42(10));
  }
}
</code></pre><p>This will print:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">add macro example: 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">add 42 example: 52</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>By having the <code>preamble</code> inside the reactor, you can define any functions or macros to be shared within the given reactor.
This will allow you to reuse code across different reactions easily within the same reactor.
This also can allow us to change the scope of items using the <code>use</code> statement.</p><p>For example, the follow reactor brings the constant <code>PI</code> into scope and prints out the first 15 digits of pi:</p><pre class="shiki"><code>target Rust;

main reactor {
  preamble {=
    use std::f64::const::PI;
  =}

  reaction(startup) {=
    println!(&quot;{}&quot;, PI);
  =}
}
</code></pre><p>This will print:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">3.141592653589793</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>By putting <code>use</code> in the <code>preamble</code>, the scope of <code>PI</code> is changed for the entire reactor, in this case the main reactor.
This works with all items that are brought into scope using the <code>use</code> statement and not just constants and functions.</p><p>This would be an example of accessing a user created module named <code>foo</code> that is included using the <code>rust-include</code> target parameter:</p><p>File: example.lf</p><pre class="shiki"><code>target Rust {
  rust-include: [&quot;foo.rs&quot;]
}
main reactor {
  preamble {=
    use crate::foo::world;
  =}
  reaction(startup) {
    world();
  }
}
</code></pre><p>File: foo.rs</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#d73a49">world</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token macro property" style="color:#36acaa">println!</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Hello, world!&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This will print:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Hello, world!</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>It is important to note that besides <a href="https://doc.rust-lang.org/book/ch07-01-packages-and-crates.html" target="_blank" rel="noopener noreferrer">crates</a> specified in the rust target declaration&#x27;s <em>cargo-dependencies</em> and user modules in <em>rust-include</em>, all user code is added to a module called <code>reactors</code> during compilation time.
This means that crate level attributes like <code>#![no_std]</code> will not work if added to the preamble.</p></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/lf-lang/lf-lang.github.io/tree/master/versioned_docs/version-0.11.0/writing-reactors/preambles.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="../generics/index.html"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Generic Reactors</div></a><a class="pagination-nav__link pagination-nav__link--next" href="../distributed-execution/index.html"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Distributed Execution</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#preamble" class="table-of-contents__link toc-highlight">Preamble</a><ul><li><a href="#using-node-modules" class="table-of-contents__link toc-highlight">Using Node Modules</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://zulip.lf-lang.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Zulip<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="../../../blog/index.html">Blog</a></li><li class="footer__item"><a href="https://github.com/lf-lang" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2026 The Lingua Franca project. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>