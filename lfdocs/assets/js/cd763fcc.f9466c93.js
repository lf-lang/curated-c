"use strict";(globalThis.webpackChunkdocusaurus_classic_typescript=globalThis.webpackChunkdocusaurus_classic_typescript||[]).push([[76168],{1708:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>ie,contentTitle:()=>te,default:()=>se,frontMatter:()=>ee,metadata:()=>ne,toc:()=>ae});var i=n(74848),a=n(28453),r=n(31848);const s='target C\n\nmain reactor {\n  state count: int = 1\n  logical action a\n\n  reaction(startup, a) -> a {=\n    printf("%d. Logical time is %lld. Microstep is %d.\\n",\n        self->count, lf_tag().time, lf_tag().microstep\n    );\n    if (self->count++ < 5) {\n      lf_schedule(a, 0);\n    }\n  =}\n}\n',l='target Cpp\n\nmain reactor {\n  state count: int(1)\n  logical action a\n\n  reaction(startup, a) -> a {=\n    std::cout << count << " Logical time is " << get_logical_time() << " Microstep: " << get_microstep() <<std::endl;\n    if (count++ < 5) {\n      a.schedule();\n    }\n  =}\n}\n',c='target Python\n\nmain reactor {\n  state count = 1\n  logical action a\n\n  reaction(startup, a) {=\n    print(\n        f"{self.count}. Logical time is {lf.tag().time}. "\n        f"Microstep is {lf.tag().microstep}."\n    )\n    if self.count < 5:\n      a.schedule(0)\n    self.count += 1\n  =}\n}\n',o='target Rust\n\nmain reactor {\n  state count: u32 = 1\n  logical action a\n\n  reaction(startup, a) -> a {=\n    let tag = ctx.get_tag();\n    println!(\n        "{}. Logical time is {}. Microstep is {}.",\n        self.count,\n        tag.offset_from_t0.as_nanos(),\n        tag.microstep(),\n    );\n    if self.count < 5 {\n      self.count += 1;\n      ctx.schedule(a, Asap);\n    }\n  =}\n}\n',p="target TypeScript\n\nmain reactor {\n  state count: number = 1\n  logical action a\n\n  reaction(startup, a) -> a {=\n    console.log(`${count}. Logical time is ${util.getCurrentLogicalTime()}. Microstep is ${util.getCurrentTag().microstep}.`)\n    if (count++ < 5) {\n      actions.a.schedule(TimeValue.zero(), null)\n    }\n  =}\n}\n";var d,h,m,g,u,f,x,y,v,j,w,E=n(96540);function M(){return M=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},M.apply(null,arguments)}const b=({title:e,titleId:t,...n})=>E.createElement("svg",M({xmlns:"http://www.w3.org/2000/svg",width:97,height:78,baseProfile:"full",viewBox:"0 0 97 78","aria-labelledby":t},n),e?E.createElement("title",{id:t},e):null,d||(d=E.createElement("desc",null,"Creator: FreeHEP Graphics2D Driver Producer: de.cau.cs.kieler.klighd.piccolo.freehep.SemanticSVGGraphics2D Revision Source:  Date: Sunday, April 10, 2022 at 9:19:33 AM Pacific Daylight Time")),E.createElement("g",{strokeMiterlimit:10},h||(h=E.createElement("path",{fill:"#fff",d:"M0 0h97v78H0z"})),m||(m=E.createElement("path",{fill:"#fff",d:"M.5 8.5v61a8 8 0 0 0 8 8h80a8 8 0 0 0 8-8v-61a8 8 0 0 0-8-8h-80a8 8 0 0 0-8 8"})),g||(g=E.createElement("path",{fill:"none",stroke:"#bebebe",d:"M.5 8.5v61a8 8 0 0 0 8 8h80a8 8 0 0 0 8-8v-61a8 8 0 0 0-8-8h-80a8 8 0 0 0-8 8z"})),E.createElement("text",{y:10,fontFamily:"Helvetica",fontSize:10,lengthAdjust:"spacingAndGlyphs",style:{whiteSpace:"pre"},textLength:54,transform:"translate(21.5 6)"},"Microsteps"),u||(u=E.createElement("path",{fill:"#fff",d:"M23.5 63a8.5 8.5 0 1 1-17 0 8.5 8.5 0 0 1 17 0"})),f||(f=E.createElement("path",{fill:"none",stroke:"#000",d:"M23.5 63a8.5 8.5 0 1 1-17 0 8.5 8.5 0 0 1 17 0z"})),x||(x=E.createElement("path",{fill:"#a6a6a6",d:"M46 23h39l6 11-6 11H46l6-11z"})),y||(y=E.createElement("path",{fill:"none",stroke:"#737373",d:"M46 23h39l6 11-6 11H46l6-11z"})),v||(v=E.createElement("path",{fill:"#fff",d:"m15 21 9 18H6z"})),j||(j=E.createElement("path",{fill:"none",stroke:"#000",d:"m15 21 9 18H6z"})),E.createElement("text",{y:8,fontFamily:"Helvetica",fontSize:8,lengthAdjust:"spacingAndGlyphs",style:{whiteSpace:"pre"},textLength:5,transform:"translate(12.5 27.7)"},"L"),w||(w=E.createElement("path",{fill:"none",stroke:"#000",strokeDasharray:"3,1",d:"M24 63h11V38h15M19.5 30H50"})))),_='target C\n\nreactor Destination {\n  input x: int\n  input y: int\n\n  reaction(x, y) {=\n    printf("Time since start: %lld, microstep: %d\\n",\n        lf_time_logical_elapsed(), lf_tag().microstep\n    );\n    if (x->is_present) {\n      printf("  x is present.\\n");\n    }\n    if (y->is_present) {\n      printf("  y is present.\\n");\n    }\n  =}\n}\n\nmain reactor {\n  logical action repeat\n  d = new Destination()\n\n  reaction(startup) -> d.x, repeat {=\n    lf_set(d.x, 1);\n    lf_schedule(repeat, 0);\n  =}\n\n  reaction(repeat) -> d.y {= lf_set(d.y, 1); =}\n}\n',S='target Cpp\n\nreactor Destination {\n  input x: int\n  input y: int\n\n  reaction(x, y) {=\n    std::cout << "Time since start: " << get_elapsed_logical_time() << " Current Microstep: " << get_microstep() << std::endl;\n    if (x.is_present()) {\n      std::cout << "x is present" << std::endl;\n    }\n    if (y.is_present()) {\n      std::cout << "y is present" << std::endl;\n    }\n  =}\n}\n\nmain reactor {\n  logical action repeat\n  d = new Destination()\n\n  reaction(startup) -> d.x, repeat {=\n    d.x.set(1);\n    repeat.schedule(0ms);\n  =}\n\n  reaction(repeat) -> d.y {= d.y.set(1); =}\n}\n',T='target Python\n\nreactor Destination {\n  input x\n  input y\n\n  reaction(x, y) {=\n    print(\n        f"Time since start: {lf.time.logical_elapsed()}, "\n        f"microstep: {lf.tag().microstep}"\n    )\n    if x.is_present:\n      print("  x is present.")\n    if y.is_present:\n      print("  y is present.")\n  =}\n}\n\nmain reactor {\n  logical action repeat\n  d = new Destination()\n\n  reaction(startup) -> d.x, repeat {=\n    d.x.set(1)\n    repeat.schedule(0)\n  =}\n\n  reaction(repeat) -> d.y {= d.y.set(1) =}\n}\n',k='target Rust\n\nreactor Destination {\n  input x: u32\n  input y: u32\n\n  reaction(x, y) {=\n    let tag = ctx.get_tag();\n    println!(\n        "Time since start: {}, microstep: {}",\n        tag.offset_from_t0.as_nanos(),\n        tag.microstep,\n    );\n    if ctx.is_present(x) {\n      println!("  x is present.");\n    }\n    if ctx.is_present(y) {\n      println!("  y is present.");\n    }\n  =}\n}\n\nmain reactor {\n  logical action repeat\n  d = new Destination()\n\n  reaction(startup) -> d.x, repeat {=\n    ctx.set(d__x, 1);\n    ctx.schedule(repeat, Asap);\n  =}\n\n  reaction(repeat) -> d.y {= ctx.set(d__y, 1); =}\n}\n',z='target TypeScript\n\nreactor Destination {\n  input x: number\n  input y: number\n\n  reaction(x, y) {=\n    console.log(`Time since start: ${util.getElapsedLogicalTime()}, microstep: ${util.getCurrentTag().microstep}`)\n    if (x !== undefined) {\n      console.log("  x is present.")\n    }\n    if (y !== undefined) {\n      console.log("  y is present.")\n    }\n  =}\n}\n\nmain reactor {\n  logical action repeat\n  d = new Destination()\n\n  reaction(startup) -> d.x, repeat {=\n    d.x = 1\n    actions.repeat.schedule(0, null)\n  =}\n\n  reaction(repeat) -> d.y {= d.y = 1 =}\n}\n';var L,A,D,H,F,C,G,P,R,O,I,V,$,J,U,q,B,N,W,K,Q,X;function Y(){return Y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Y.apply(null,arguments)}const Z=({title:e,titleId:t,...n})=>E.createElement("svg",Y({xmlns:"http://www.w3.org/2000/svg",width:291,height:108,baseProfile:"full",viewBox:"0 0 291 108","aria-labelledby":t},n),e?E.createElement("title",{id:t},e):null,L||(L=E.createElement("desc",null,"Creator: FreeHEP Graphics2D Driver Producer: de.cau.cs.kieler.klighd.piccolo.freehep.SemanticSVGGraphics2D Revision Source:  Date: Sunday, April 10, 2022 at 9:31:53 AM Pacific Daylight Time")),E.createElement("g",{strokeMiterlimit:10},A||(A=E.createElement("path",{fill:"#fff",d:"M0 0h291v108H0z"})),D||(D=E.createElement("path",{fill:"#fff",d:"M.5 8.5v91a8 8 0 0 0 8 8h274a8 8 0 0 0 8-8v-91a8 8 0 0 0-8-8H8.5a8 8 0 0 0-8 8"})),H||(H=E.createElement("path",{fill:"none",stroke:"#bebebe",d:"M.5 8.5v91a8 8 0 0 0 8 8h274a8 8 0 0 0 8-8v-91a8 8 0 0 0-8-8H8.5a8 8 0 0 0-8 8z"})),E.createElement("text",{y:10,fontFamily:"Helvetica",fontSize:10,lengthAdjust:"spacingAndGlyphs",style:{whiteSpace:"pre"},textLength:65,transform:"translate(113 6)"},"Simultaneous"),F||(F=E.createElement("path",{fill:"#fff",d:"M23.5 56a8.5 8.5 0 1 1-17 0 8.5 8.5 0 0 1 17 0"})),C||(C=E.createElement("path",{fill:"none",stroke:"#000",d:"M23.5 56a8.5 8.5 0 1 1-17 0 8.5 8.5 0 0 1 17 0z"})),G||(G=E.createElement("path",{fill:"#f2f2f2",d:"M210.2 29.5v64a8 8 0 0 0 8 8h58.3a8 8 0 0 0 8-8v-64a8 8 0 0 0-8-8h-58.3a8 8 0 0 0-8 8"})),P||(P=E.createElement("path",{fill:"none",stroke:"#bebebe",d:"M210.2 29.5v64a8 8 0 0 0 8 8h58.3a8 8 0 0 0 8-8v-64a8 8 0 0 0-8-8h-58.3a8 8 0 0 0-8 8z"})),E.createElement("text",{y:10,fontFamily:"Helvetica",fontSize:10,lengthAdjust:"spacingAndGlyphs",style:{whiteSpace:"pre"},textLength:55,transform:"translate(219.85 27)"},"Destination"),R||(R=E.createElement("path",{fill:"#a6a6a6",d:"M234 45h39l6 11-6 11h-39l6-11z"})),O||(O=E.createElement("path",{fill:"none",stroke:"#737373",d:"M234 45h39l6 11-6 11h-39l6-11z"})),I||(I=E.createElement("path",{fill:"none",stroke:"#000",strokeDasharray:"3,1",d:"M213 81h13.5V60H238M213 52h25"})),E.createElement("text",{y:8,fontFamily:"Helvetica",fontSize:8,lengthAdjust:"spacingAndGlyphs",style:{whiteSpace:"pre"},textLength:5,transform:"translate(199 37)"},"y"),V||(V=E.createElement("path",{d:"m205 48 8 4-8 4z"})),$||($=E.createElement("path",{fill:"none",stroke:"#000",d:"m205 48 8 4-8 4z"})),E.createElement("text",{y:8,fontFamily:"Helvetica",fontSize:8,lengthAdjust:"spacingAndGlyphs",style:{whiteSpace:"pre"},textLength:5,transform:"translate(199 86)"},"x"),J||(J=E.createElement("path",{d:"m205 77 8 4-8 4z"})),U||(U=E.createElement("path",{fill:"none",stroke:"#000",d:"m205 77 8 4-8 4z"})),q||(q=E.createElement("path",{fill:"#a6a6a6",d:"M39 45h39l6 11-6 11H39l6-11z"})),B||(B=E.createElement("path",{fill:"none",stroke:"#737373",d:"M39 45h39l6 11-6 11H39l6-11z"})),E.createElement("text",{y:10,fontFamily:"Helvetica",fontSize:10,fontWeight:"bold",lengthAdjust:"spacingAndGlyphs",style:{whiteSpace:"pre"},textLength:5,transform:"translate(59 50)"},"1"),N||(N=E.createElement("path",{fill:"#a6a6a6",d:"M139 41h39l6 11-6 11h-39l6-11z"})),W||(W=E.createElement("path",{fill:"none",stroke:"#737373",d:"M139 41h39l6 11-6 11h-39l6-11z"})),E.createElement("text",{y:10,fontFamily:"Helvetica",fontSize:10,fontWeight:"bold",lengthAdjust:"spacingAndGlyphs",style:{whiteSpace:"pre"},textLength:7,transform:"translate(158 46)"},"2"),K||(K=E.createElement("path",{fill:"#fff",d:"m115 43 9 18h-18z"})),Q||(Q=E.createElement("path",{fill:"none",stroke:"#000",d:"m115 43 9 18h-18z"})),E.createElement("text",{y:8,fontFamily:"Helvetica",fontSize:8,lengthAdjust:"spacingAndGlyphs",style:{whiteSpace:"pre"},textLength:5,transform:"translate(112.5 49.7)"},"L"),X||(X=E.createElement("path",{fill:"none",stroke:"#000",strokeDasharray:"3,1",d:"M24 56h21M82 60h13v21h110M184 52h21M82 52h28.5M119.5 52H145"})))),ee={title:"Superdense Time",description:"Superdense time in Lingua Franca."},te=void 0,ne={id:"writing-reactors/superdense-time",title:"Superdense Time",description:"Superdense time in Lingua Franca.",source:"@site/versioned_docs/version-0.7.0/writing-reactors/superdense-time.mdx",sourceDirName:"writing-reactors",slug:"/writing-reactors/superdense-time",permalink:"/docs/0.7.0/writing-reactors/superdense-time",draft:!1,unlisted:!1,editUrl:"https://github.com/lf-lang/lf-lang.github.io/tree/master/versioned_docs/version-0.7.0/writing-reactors/superdense-time.mdx",tags:[],version:"0.7.0",frontMatter:{title:"Superdense Time",description:"Superdense time in Lingua Franca."},sidebar:"handbookSidebar",previous:{title:"Actions",permalink:"/docs/0.7.0/writing-reactors/actions"},next:{title:"Modal Reactors",permalink:"/docs/0.7.0/writing-reactors/modal-models"}},ie={},ae=[{value:"Tag vs. Time",id:"tag-vs-time",level:2},{value:"Logical Simultaneity",id:"logical-simultaneity",level:2},{value:"Alignment of Logical and Physical Times",id:"alignment-of-logical-and-physical-times",level:2}];function re(e){const t={a:"a",code:"code",em:"em",h2:"h2",p:"p",pre:"pre",strong:"strong",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.Gv,{c:!0,cpp:!0,py:!0,rs:!0,ts:!0}),"\n",(0,i.jsx)(t.h2,{id:"tag-vs-time",children:"Tag vs. Time"}),"\n",(0,i.jsxs)(t.p,{children:["The model of time in Lingua Franca is a bit more sophisticated than we have hinted at. Specifically, a ",(0,i.jsx)(t.strong,{children:"superdense"})," model of time is used. In particular, instead of a ",(0,i.jsx)(t.strong,{children:"timestamp"}),", LF uses a ",(0,i.jsx)(t.strong,{children:"tag"}),", which consists of a ",(0,i.jsx)(t.strong,{children:"logical time"})," ",(0,i.jsx)(t.em,{children:"t"})," and a ",(0,i.jsx)(t.strong,{children:"microstep"})," ",(0,i.jsx)(t.em,{children:"m"}),"."]}),"\n",(0,i.jsxs)(t.p,{children:["A ",(0,i.jsxs)(t.a,{href:"/docs/0.7.0/writing-reactors/actions#logical-actions",children:[(0,i.jsx)(t.code,{children:"logical"})," ",(0,i.jsx)(t.code,{children:"action"})]})," may have a ",(0,i.jsx)(t.code,{children:"<min_delay>"})," of zero, and the ",(0,i.jsx)(t.code,{children:"<offset>"})," argument to the ",(0,i.jsx)(t.code,{children:"schedule()"})," function may be zero. In this case, the call to ",(0,i.jsx)(t.code,{children:"schedule(>)"})," appears to be requesting that the action trigger at the ",(0,i.jsx)(t.em,{children:"current logical time"}),". Here is where superdense time comes in. The action will indeed trigger at the current logical time, but one microstep later. Consider the following example:"]}),"\n","\n",(0,i.jsx)(r.UJ,{c:s,cpp:l,py:c,rs:o,ts:p,lf:!0}),"\n","\n",(0,i.jsx)(b,{title:"Lingua Franca diagram: Microsteps",role:"img",width:"150"}),"\n",(0,i.jsx)(t.p,{children:"Executing this program will yield something like this:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"1. Logical time is 1649607749415269000. Microstep is 0.\n2. Logical time is 1649607749415269000. Microstep is 1.\n3. Logical time is 1649607749415269000. Microstep is 2.\n4. Logical time is 1649607749415269000. Microstep is 3.\n5. Logical time is 1649607749415269000. Microstep is 4.\n"})}),"\n",(0,i.jsxs)(t.p,{children:["Notice that the logical time is not advancing, but the microstep is (the logical time, in this case, gives the number of nanoseconds that have elapsed since January 1, 1970). The general rule is that ",(0,i.jsx)(t.strong,{children:"every"})," call to ",(0,i.jsx)(t.code,{children:"schedule()"})," advances the tag by at least one microstep."]}),"\n",(0,i.jsx)(t.h2,{id:"logical-simultaneity",children:"Logical Simultaneity"}),"\n",(0,i.jsxs)(t.p,{children:["Two events are ",(0,i.jsx)(t.strong,{children:"logically simultaneous"})," only if ",(0,i.jsx)(t.em,{children:"both"})," the logical time and the microstep are equal. The following example illustrates this:"]}),"\n","\n",(0,i.jsx)(r.UJ,{c:_,cpp:S,py:T,rs:k,ts:z,lf:!0}),"\n","\n",(0,i.jsx)(Z,{title:"Lingua Franca diagram: Simultaneous",role:"img",width:"400"}),"\n",(0,i.jsxs)(t.p,{children:["The ",(0,i.jsx)(t.code,{children:"Destination"})," reactor has two inputs, ",(0,i.jsx)(t.code,{children:"x"})," and ",(0,i.jsx)(t.code,{children:"y"}),", and it reports in a reaction to either input what is the logical time, the microstep, and which input is present. The main reactor reacts to ",(0,i.jsx)(t.code,{children:"startup"})," by sending data to the ",(0,i.jsx)(t.code,{children:"x"})," input of ",(0,i.jsx)(t.code,{children:"Destination"}),". It then schedules a ",(0,i.jsx)(t.code,{children:"repeat"})," action with an ",(0,i.jsx)(t.code,{children:"<offset>"})," of zero. The ",(0,i.jsx)(t.code,{children:"repeat"})," reaction is invoked ",(0,i.jsx)(t.strong,{children:"strictly later"}),", one ",(0,i.jsx)(t.strong,{children:"microstep"})," later. The output printed, therefore, will look like this:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"Time since start: 0, microstep: 0\n  x is present.\nTime since start: 0, microstep: 1\n  y is present.\n"})}),"\n",(0,i.jsxs)(t.p,{children:["The reported elapsed logical time has not advanced in the second reaction, but the fact that ",(0,i.jsx)(t.code,{children:"x"})," is not present in the second reaction proves that the first reaction and the second are not logically simultaneous. The second occurs one microstep later."]}),"\n",(0,i.jsx)(t.h2,{id:"alignment-of-logical-and-physical-times",children:"Alignment of Logical and Physical Times"}),"\n",(0,i.jsx)(t.p,{children:'Recall that in Lingua Franca, logical time "chases" physical time, invoking reactions at a physical time close to their logical time. For that purpose, the microstep is ignored.'})]})}function se(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(re,{...e})}):re(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>s,x:()=>l});var i=n(96540);const a={},r=i.createContext(a);function s(e){const t=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),i.createElement(r.Provider,{value:t},e.children)}}}]);