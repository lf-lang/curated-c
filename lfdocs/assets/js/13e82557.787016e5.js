"use strict";(globalThis.webpackChunkdocusaurus_classic_typescript=globalThis.webpackChunkdocusaurus_classic_typescript||[]).push([[70091],{4237:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>i,metadata:()=>a,toc:()=>c});var s=n(74848),o=n(28453);const i={title:"Patmos",description:"Developing LF Programs for Patmos."},r="Overview",a={id:"embedded/patmos",title:"Patmos",description:"Developing LF Programs for Patmos.",source:"@site/versioned_docs/version-0.11.0/embedded/patmos.mdx",sourceDirName:"embedded",slug:"/embedded/patmos",permalink:"/docs/embedded/patmos",draft:!1,unlisted:!1,editUrl:"https://github.com/lf-lang/lf-lang.github.io/tree/master/versioned_docs/version-0.11.0/embedded/patmos.mdx",tags:[],version:"0.11.0",frontMatter:{title:"Patmos",description:"Developing LF Programs for Patmos."},sidebar:"handbookSidebar",previous:{title:"Arduino",permalink:"/docs/embedded/arduino"},next:{title:"Zephyr",permalink:"/docs/embedded/zephyr"}},l={},c=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Getting Started",id:"getting-started",level:3},{value:"Compiling and Running Lingua Franca codes",id:"compiling-and-running-lingua-franca-codes",level:3}];function d(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"overview",children:"Overview"})}),"\n",(0,s.jsxs)(t.p,{children:["Lingua Franca's C-runtime supports ",(0,s.jsx)(t.a,{href:"https://github.com/t-crest/patmos",children:"Patmos"}),",\na bare-metal execution platform that is optimized for time-predictable execution.\nThe time-predictability aspect of Patmos makes it easier to obtain a worst-case\nexecution time (WCET) for reactions."]}),"\n",(0,s.jsx)(t.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Linux or macOS development system. (use WSL on Windows)"}),"\n",(0,s.jsx)(t.li,{children:"DE2-115 Development Kit, which is equipped with Altera Cyclone IV FPGA (optional)"}),"\n"]}),"\n",(0,s.jsx)(t.h3,{id:"getting-started",children:"Getting Started"}),"\n",(0,s.jsxs)(t.p,{children:["To know how to install the toolchain for building Patmos, read the Patmos project's readme at ",(0,s.jsx)(t.a,{href:"https://github.com/t-crest/patmos",children:"https://github.com/t-crest/patmos"})," or study the sixth chapter of its handbook available here: ",(0,s.jsx)(t.a,{href:"http://patmos.compute.dtu.dk/patmos_handbook.pdf",children:"Patmos Reference Handbook"})]}),"\n",(0,s.jsx)(t.h3,{id:"compiling-and-running-lingua-franca-codes",children:"Compiling and Running Lingua Franca codes"}),"\n",(0,s.jsx)(t.p,{children:"Patmos can run in an FPGA, but there are also two simulators available:"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"pasim"}),": a software ISA simulator that is written in C++."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"patemu"}),": a cycle-accurate hardware emulator generated from the hardware description."]}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["Consider the following simple LF program inside the HelloPatmos.lf file located in ",(0,s.jsx)(t.code,{children:"test/C/src/patmos/HelloPatmos.lf"}),":"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-lf-c",children:'target C {\n\tplatform: "Patmos",\n\tsingle-threaded: true,\n\tbuild-type: Debug, \n}\n\nmain reactor {\n\treaction(startup) {=\n\t\tprintf("Hello World!\\n");\n\t=}\n}\n  \n\n'})}),"\n",(0,s.jsxs)(t.p,{children:["You can generate C code using ",(0,s.jsx)(t.code,{children:"lfc HelloPatmos.lf"})," command in the above folder:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"cd test/C/src/patmos/\nlfc HelloPatmos.lf\n"})}),"\n",(0,s.jsxs)(t.p,{children:["If there is no error after making, an executable file must be generator inside ",(0,s.jsx)(t.code,{children:"src-gen/patmos/HelloPatmos"})," folder. Then, the reactor can be executed on the SW simulator with the following command:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"cd ../../src-gen/patmos/HelloPatmos/build\npasim HelloPatmos\n"})}),"\n",(0,s.jsx)(t.p,{children:"After executing the above command, the following lines must be printed."}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"Hello World!\n---- Elapsed logical time (in nsec): 0\n---- Elapsed physical time (in nsec): 770,000\n"})}),"\n",(0,s.jsx)(t.p,{children:"The reactor can also be executed on the hardware emulator of Patmos:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"patemu HelloPatmos\n"})}),"\n",(0,s.jsx)(t.p,{children:"This execution is considerably slower than the SW simulator, as the concrete hardware\nof Patmos is simulated cycle-accurate. Here is a sample of its output:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"Hello World!\n---- Elapsed logical time (in nsec): 0\n---- Elapsed physical time (in nsec): 3,459,000\n"})})]})}function h(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>a});var s=n(96540);const o={},i=s.createContext(o);function r(e){const t=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),s.createElement(i.Provider,{value:t},e.children)}}}]);